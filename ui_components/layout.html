<div component="layout">
	<w-c>
		((elements))
		<f sort="(( m1.id_ - m2.id_ ))" >
		
		<w-s export="((insert))">
			((lvl_))((tag))((id_))

			<button onclick="((add)())"></button>

			<script on="((add))">
				emit("insert", model);
			</script>
		</w-s>
	</w-c>

	<script on="((insert))">

		let sib_node = insert;

		let root = wick.core.source.compiler.nodes.root;

		let node = new root();
		node.par = sib_node.par;
		node._presets_ = presets;

		node._parse_(wick.core.lexer("<span>Testing</span>")).then(n=>{
			node.par = null;
			sib_node.insertAfter(node);
			node.setRebuild(false, true, true);
        	node.rebuild();

        	emit("target", src.target);
		});

	</script>

	<script on="((target))">
		let elements = [];
		//extract all elements and present on a grid

		let ast = target.component.sources[0].ast;
		let count = 0;
		function toOut(src, level){
			if(src.type == 1) return;

			src.id_ = count++;
			src.lvl_ = level;

			elements.push(src);

			let children = src.children;

			if(children)
			for(let i = 0; i < children.length; i++)
				toOut(children[i], level + 1);
		}

		toOut(ast, 0);

		emit("elements", elements);
	</script>
</div>